여기서 정리하는 문서에서는 캐시 + RabbitMQ + Spring Batch 로 1초에 20번의 메시지를 발생시켜서 웹소켓으로 뿌려주고, 1초에 20번의 메시지를 100개까지 모아뒀다가 Bulk Insert 를 하는 토이 수준의 채팅앱을 만드는 과정을 정리해볼 예정이다. <br>

이 정도 토이 수준의 앱이라면 마음먹고 2주일 정도 아무것도 안시키고 이것만 하라고 하면 자료를 충분히 찾아서 해결해내시는 분들도 많지 않을까싶다. 그런데, 3가지 자료(캐시, 래빗엠큐, 스프링 배치)를 한꺼번에 공부하는 것은 쉽지도 않고, 나중에 다시 기억이 나지 않을 확률이 너무나 많기 때문에 최대한 직관적인 예제로 정리해두기로 마음 먹었다. <br>

소스코드를 작성하는 것은 쉬운데, 설명하는 것은 너무나 힘들고 귀찮은 일이라 다 할 수 있을지 걱정이긴 하다.  

---

**캐싱서비스 + 큐 관련 자료조사 내용**<br>

만약 초당 9000건을 그대로 단건으로 일일이 DB에 저장하면 JVM + DB에 문제가 생기기에 나름의 대책을 세웠는데, 여기에 대해 찾아본 것도 그림을 그려두어야 할 것 같다. 이것을 찾아보고 여러가지를 직접 적용해보는 데에 시간이 조금 걸렸었다. 업무시간 외에 개인 시간에 공부를 해서 적용하는 호구같은 한달을 보냈다. 호구도 이런 호구가 없다.<br>

진짜... 개발버전으로 뭐 하나 적용했다가... 어? 이거 아니다. 하고 다른 자료 검색하고, 이거 적용하고나니 다른 더 좋은게 있어서 다시 찾아서 공식문서 보면서 적용하고 하는 과정이 정말 ㅋㅋㅋ 많았다. 나와 같은 위기(?)에 처한 다른 개발자들의 글들도 가끔은 볼수 있었던 것 같다.

---

**RabbitMQ 적용기**<br>

주로 공식문서를 굉장히 많이 봤다. 공식문서를 보고 파악해온 내용들을 정리해보려 한다. 9월 중순 쯤에 어느 정도 문서 정리가 마무리 될 것 같다. 처음 공부할 때는 영어 자료밖에 없어서 힘들었는데, 공식문서를 보다 보니 어느 정도 익숙해졌고, 공식문서를 보고 바로 적용해서 테스트 해볼 때마다 어느 정도 내 실력도 성장해갔다는 걸 느꼈다. 대신 글쓰는 스킬이 줄어들었다.<br>

---

**Spring Batch**<br>

스프링 배치는 이번에 처음 써봤다. JPA나 QueryDsl을 써서 멋있게 할수도 있는데, Bulk Insert의 경우 가장 안정적으로 동작하는 것은 JdbcTemplate 이여서 이번 예제는 JdbcTemplate 기반의 예제이다.<br>

추후 고도화 시에 도메인 모델이 확실해지면 JPA, QueryDsl을 적용하거나, spring data flow 또는 rxjava 를 적용하게 되지 않을까 싶기도 하다. 실제 적용해본 경험으로는 rxjava 의 생산자 소비자 모델이 조금 잘 맞는다는 기분이 들었었다.<br>

---

**아쉬웠던 점**<br>

요즘 나에 대해 다시 생각해보는게 단거리 경주를 자꾸 장거리 뛰듯이 자주해오진 않았을까 하는 생각이다. 지금까지 쌓은 기술만 가지고 우려먹으려 하는 그냥 회사원이 되면 딱 그 수준밖에 안된다는 생각이 들어서 매일 평일마다 공부한 내용을 정리해왔다. 전 회사에서는 업무시간에 스터디하는 것이 어느 정도 가능했다. 정해진 업무가 있고 운영업무 성과를 (=개발/QA 해결건수) 파악하기 쉬웠기 때문이다.<br>

하지만, 이번 프로젝트는 실무와 학습을 병행하지 못했다. 기존 로직을 마이그레이션 + 새로운 기술적용을 해야 했는데, 막상 회사에서는 눈치가 보여서 공부하지도 못하고 마이그레이션 작업을 하고 집에 가면서 + 집 + 주말에 숨어서 공부했다. <br>

회사 소스의 대부분은 주말/집 공부의 결과물 + 광복절 연휴에 애국심을 불사른 재택근무 의 결과물이다. 로직 마이그레이션 작업은 업무시간에 했지만, 인수인계 없이 1인 에게 모두 책임을 전가하는 스타트업이다 보니, 기존 비지니스 파악에 시간이 꽤 걸렸고, 결합도가 엄청나게 높아서 파악이 굉장히 어렵던 구조를 의존성을 하나 하나 해체하는 데만도 엄청난 시간이 걸렸다. 로직을 한번 깔끔하게 들어엎고 나면 한단계 더 나가서 들어 엎어야 했고, 그 다음에는 또 다른 레베루의 고난이 계속 있었다. 여기에 더해서 알고 있던게 아닌 새로 아이디어를 떠올려서 구조를 풀어야 하다보니 진도가 안나갈때는 답답하기도 했다.<br>

<br>
